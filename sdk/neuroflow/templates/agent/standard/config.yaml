# ${agent_name} Agent Configuration
# 版本：v0.4.1

agent:
  name: ${agent_name}
  description: "${description}"
  workspace: "./${workspace_name}"

llm:
  provider: ${llm_provider}
  model: ${llm_model}
  temperature: 0.7
  max_tokens: 4096

# MCP 服务器配置
# 默认启用 filesystem 和 memory 服务器
mcp:
  # 全局开关
  enabled: true
  
  # 服务器列表
  servers:
    # 文件系统 MCP 服务器
    # 提供安全的文件读写能力
    - name: filesystem
      enabled: true
      description: "File system access for reading and writing files"
      config:
        # 允许访问的路径（相对于项目根目录）
        allowed_paths:
          - "./${workspace_name}"
          - "./docs"
        # 禁止访问的路径
        denied_paths:
          - "/etc"
          - "/usr"
          - "/var"
          - "$HOME/.ssh"
          - "$HOME/.aws"
        # 允许的文件操作
        allowed_operations:
          - read
          - write
          - list
        # 禁止的文件操作
        denied_operations:
          - delete
          - chmod
        # 文件大小限制（MB）
        max_file_size_mb: 10
    
    # 记忆 MCP 服务器
    # 提供长期记忆存储能力
    - name: memory
      enabled: true
      description: "Long-term memory storage"
      config:
        # 数据库路径
        db_path: "./${workspace_name}/memory.db"
        # 最大记忆数量
        max_memories: 1000
        # 自动清理过期记忆
        auto_cleanup: true
    
    # Terminal 服务器（默认禁用）
    # 提供命令执行能力，需要谨慎配置
    - name: terminal
      enabled: false  # ⚠️ 默认禁用，需要时手动启用
      description: "Terminal command execution (DISABLED BY DEFAULT)"
      config:
        # 执行模式：restricted | permissive
        mode: restricted
        
        # 命令白名单（仅 restricted 模式有效）
        allowed_commands:
          - ls
          - dir
          - cat
          - head
          - tail
          - grep
          - find
          - wc
          - pwd
        
        # 命令黑名单（所有模式都有效）
        denied_commands:
          - rm
          - del
          - curl
          - wget
          - apt
          - yum
          - brew
          - sudo
          - su
        
        # 管道命令拦截
        block_pipes: true  # 拦截 curl|bash 类命令
        
        # 资源限制
        resource_limits:
          timeout_seconds: 30
          max_memory_mb: 512
          max_output_lines: 1000
        
        # 需要确认的操作
        require_confirmation:
          - "rm*"
          - "kill*"
          - "sudo*"

# 安全配置
security:
  # API Key 管理
  api_keys:
    # 从环境变量读取（推荐）
    use_environment: true
    # 或者在这里配置（不推荐）
    # openai_api_key: "sk-xxx"
    # anthropic_api_key: "sk-ant-xxx"
  
  # 审计日志
  audit:
    enabled: true
    log_file: "./${workspace_name}/audit.log"
    log_level: "INFO"
    
    # 记录的操作类型
    log_operations:
      - tool_call
      - mcp_access
      - file_access
      - command_execution

# 可观测性配置
observability:
  tracing:
    enabled: false
    export_endpoint: "http://localhost:4317"
  
  metrics:
    enabled: true
    export_interval_seconds: 60

# 日志配置
logging:
  level: "INFO"  # DEBUG | INFO | WARNING | ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "./${workspace_name}/agent.log"
